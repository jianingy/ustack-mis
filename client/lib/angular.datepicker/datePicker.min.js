angular.module('datePicker', []).directive('datePicker', function () {
  return {
    link : function( $scope, $elem, $attrs){

      setChildByName = function(obj, name, val) {
        var field, i, ns, ref, _i, _len;

        ns = name.split(".");
        ref = obj;
        for (i = _i = 0, _len = ns.length; _i < _len; i = ++_i) {
          field = ns[i];
          if (i === ns.length - 1) {
            return ref[field] = val;
          }
          if (ref != null ? ref[field] : void 0) {
            ref = ref[field];
          }
        }
        return res;
      };

      $elem.datepicker()
      $elem.on("changeDate",function( ){
        setChildByName( $scope, $attrs['ngModel'], $elem.val())
        console.log( "date",  $elem.val(), arguments, $scope)        
      })
    }
  }
})    

